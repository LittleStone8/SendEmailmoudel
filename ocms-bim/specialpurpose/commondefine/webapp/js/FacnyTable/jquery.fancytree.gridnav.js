!function(e,n,t,i){"use strict";function r(n,t){var i,r=t.get(0),o=0;return n.children().each(function(){if(this===r)return!1;i=e(this).prop("colspan"),o+=i||1}),o}function o(n,t){var i,r=null,o=0;return n.children().each(function(){if(o>=t)return r=e(this),!1;i=e(this).prop("colspan"),o+=i||1}),r}function a(e,n){var t,i,a=e.closest("td"),c=null;switch(n){case s.LEFT:c=a.prev();break;case s.RIGHT:c=a.next();break;case s.UP:case s.DOWN:for(t=a.parent(),i=r(t,a);;){if(t=n===s.UP?t.prev():t.next(),!t.length)break;if(!t.is(":hidden")&&((c=o(t,i))&&c.find(":input,a").length))break}}return c}var s=e.ui.keyCode,c={text:[s.UP,s.DOWN],checkbox:[s.UP,s.DOWN,s.LEFT,s.RIGHT],link:[s.UP,s.DOWN,s.LEFT,s.RIGHT],radiobutton:[s.UP,s.DOWN,s.LEFT,s.RIGHT],"select-one":[s.LEFT,s.RIGHT],"select-multiple":[s.LEFT,s.RIGHT]};e.ui.fancytree.registerExtension({name:"gridnav",version:"@VERSION",options:{autofocusInput:!1,handleCursorKeys:!0},treeInit:function(n){this._requireExtension("table",!0,!0),this._superApply(arguments),this.$container.addClass("fancytree-ext-gridnav"),this.$container.on("focusin",function(t){var i,r=e.ui.fancytree.getNode(t.target);r&&!r.isActive()&&(i=n.tree._makeHookContext(r,t),n.tree._callHook("nodeSetActive",i,!0))})},nodeSetActive:function(n,t){var i,r=n.options.gridnav,o=n.node,a=n.originalEvent||{},s=e(a.target).is(":input");t=!1!==t,this._superApply(arguments),t&&(n.options.titlesTabbable?(s||(e(o.span).find("span.fancytree-title").focus(),o.setFocus()),n.tree.$container.attr("tabindex","-1")):r.autofocusInput&&!s&&(i=e(o.tr||o.span),i.find(":input:enabled:first").focus()))},nodeKeydown:function(n){var t,i,r,o=n.options.gridnav,s=n.originalEvent,u=e(s.target);return u.is(":input:enabled")?t=u.prop("type"):u.is("a")&&(t="link"),t&&o.handleCursorKeys?!((i=c[t])&&e.inArray(s.which,i)>=0&&(r=a(u,s.which))&&r.length)||(r.find(":input:enabled,a").focus(),!1):this._superApply(arguments)}})}(jQuery,window,document);